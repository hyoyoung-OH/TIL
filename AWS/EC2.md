# EC2(Amazon Elastic Compute Cloud)
475개가 넘는 인스턴스, 그리고 최신 프로세서, 스토리지, 네트워킹, 운영 체제 및 구매 모델의 옵션과 함께 워크로드의 요구 사항에 가장 잘 부합할 수 있도록 가장 포괄적이고 심층적인 컴퓨팅 플랫폼을 제공

## AMI(Amazone Elastic Compute Cloud)
인스턴스를 시작하는 데 필요한 소프트웨어 구성(운영체제, 어플리케이션 서버, 어플리케이션)이 포함된 템플릿. AWS, 사용자 커뮤니티 또는 AWS Marketplace에서 제공하는 AMI를 선택하거나 자체 AMI 중 하나를 선택할 수 있음.
>##### **Instance**: 어플리케이션을 실행할 수 있는 가상 서버로, 하나의 컴퓨터라고 이해하면 된다.

## VPC(Virtual Private Cloud)
- 네트워크 계층의 서비스
- EC2 인스턴스를 비롯한 여러 AWS 서비스의 리소스를 담을 수 있는 **가상 네트워크**
- 한 AWS 리전 안에서만 존재할 수 있고, 한 리전에 만든 VPC는 다른 리전에서는 보이지 않음
- 연속적인 IP 주소 범위로 구성 -> CIDR블록(네트워크 ID와 호스트 ID를 구분)으로 표기
    - 10.0.0.0/8 		⇒ 10.0.0.0 ~ 10.255.255.255
    - 172.16.0.0/12 		⇒ 172.16.0.0 ~ 172.31.255.255
    - 192.168.0.0/16 	⇒ 192.168.0.0 ~ 192.168.255.255

## Subnet
- VPC 내의 논리적인 구분: **인스턴스를 서로 격리하고 인스턴스 간의 트래픽 허용을 제어하고 인스턴스를 기능별로 묶을 수 있음**
- EC2 인스턴스를 배치하는 장소: 인스턴스는 서브넷 안에 위치
    - 한번 서브넷에 인스턴스를 생성하면 다른 서브넷으로 옮길 수 없음
    - 인스턴스를 종료하고 다른 서브넷에 새 인스턴스를 만들 수는 있음
- 서브넷은 하나의 가용영역(AZ, Availablity Zone)내에서만 존재할 수 있음
- 서브넷 CIDR 블록
    - VPC의 일부, VPC 내에서는 유니크해야함
    - 모든 서브넷에서 처음 4개의 IP와 마지막 1개는 예약되어 있으므로 인스턴스에 할당할 수 없음 

## ENI(Elastic Network Interface)
- 물리 서버의 네트워크 인터페이스 컨트롤러(NIC = 네트워크 카드)와 같은 기능을 수행
- EC2 생성 시 기본 네트워크 인터페이스 생성
- EC2에 추가로 네트워크 인터페이스 연결이 가능

## 인터넷 게이트웨이(igw)
- 퍼블릭 IP 주소를 할당받은 인스턴스가 인터넷과 연결되어서 요청을 수신할 수 있도록 기능을 제공
- VPC를 처음 생산하면 igw가 연결되어 있지 않으므로 직접 igw를 생성하여 VPC와 연결해야함
- **하나의 VPC는 하나의 igw와 연결할 수 있음**

## Routing
- VPC는 소프트웨어 함수로 IP 라우팅을 구현 ⇒ 사용자는 라우팅 테이블만 관리
- 기본 라우팅 = 인터넷 게이트웨이를 가리키는 라우팅
- 퍼블릭 서브넷 : 기본 라우팅이 포함된 라우팅 테이블과 연결된 서브넷 
- 프라이빗 서브넷 : 기본 라우팅이 포함되지 않은 라우팅 테이블과 연결된 서브넷  
- 라우팅할 위치와 가장 근접하게 일치하는 항목을 기반으로 라우팅을 처리 ⇒ 라우팅 테이블에 항목들의 순서는 중요하지 않음
아래와 같은 형태로 라우팅 테이블이 설정된 경우, 192.51.100.50으로 패킷을 보낼려고 하면, 
가장 근접한 규칙에 따라 인터넷 게이트웨이로 라우팅이 됨
```
----------------------	--------------------------
대상 주소              	대상
----------------------	--------------------------
172.31.0.0/16 			LOCAL
0.0.0.0/0			igw-xxxxxxxxxx
----------------------	--------------------------
```
## 보안그룹(sg: Security Group)
- 방화벽과 같은 기능을 제공
- **인스턴스의 ENI**에서 송수신하는 트래픽을 허가해서 트래픽을 제어
- 모든 ENI는 최소 한 개 이상의 보안 그룹과 연결되어야하고, 보안 그룹은 여러 ENI와 연결될 수 있음
- 보안그룹을 생성할 때 보안 그룹 이름, 설명, 포함될 VPC를 지정하고 생성 후에는 인바운드, 아웃바운드 규칙을 지정
- **상태 저장 방화벽** 역할: 보안 그룹이 트래픽을 한 방향으로 전달하도록 허용할 때 반대 방향의 응답 트래픽을 지능적으로 허용/ 웹 클라이언트에서 HTTPS로 요청했다면 요청에 대한 응답도 (자동으로) 허용

## NACL(Network Access Control List)
- 보안그룹과 유사
    - Source(출발지) 주소 또는 대상 주소 CIDR, 프로토콜, 포트를 기반으로 트래칙을 인바운드, 아웃바운드 규칙으로 제어 => 방화벽과 같은 역할
    - VPC에는 삭제할 수 없는 기본 네트워크 ACL이 있음
- **서브넷에 연결**되어 해당 서브넷과 송수신하는 트래픽을 제어
- **상태 비저장**
    - NACL을 통과한 연결상태를 추적하지 않음
    - 모든 인바운드와 아웃바운드 트래픽의 허용 규칙을 별도로 작성해야함
- **규칙을 적용할 때 규칙 번호의 오름차순으로 처리**: 규칙 번호가 작은 것을 우선적으로 처리

## Elastic IP
- 인터넷에 연결 가능한 퍼블릭 IP주소
- AWS에서 고정적인 퍼블릭 IP주소를 할당받을 수 있음(유료 서비스)
- EC2 인스턴스를 중지하고 다시 시작하면 퍼블릭 IP주소가 변경되나, EC2 인스턴스에 탄력적 IP 주소를 연결하면 EC2인스턴스를 다시 시작해도 동일한 IP 주소로 접속이 가능
